# 💰 프로젝트 비용 분석 및 0원 운영 전략 (Fly.io)

이 문서는 `soop-chat-ji` 봇 서버를 Fly.io에서 운영할 때의 예상 비용과, 트래픽 증가와 무관하게 비용을 **완전 무료($0)**로 유지하기 위한 아키텍처 전략을 기술합니다.

## 1. Fly.io 비용 구조 분석

Fly.io는 모든 사용자에게 매달 **$5.00**의 무료 이용 크레딧(Free Credit)을 제공합니다. 이 한도 내에서 사용하면 실제 청구 금액은 0원입니다.

### 📉 고정 비용 (서버 유지비)
*   **인스턴스**: `shared-cpu-1x` (256MB RAM)
*   **가동 시간**: 24시간 365일 (Always on)
*   **월 예상 비용**: **-$1.94** (약 2,600원)
*   **IP 주소**: `Shared IPv4` 사용 시 **$0** (무료)

### 💵 남은 가용 예산
*   $5.00 (크레딧) - $1.94 (서버) = **$3.06 (약 4,000원)**
*   이 남은 예산을 모두 **데이터 전송(Outbound Traffic)**에 사용할 수 있습니다.

---

## 2. 데이터 전송량 및 한계점 계산

데이터 전송 비용이 가장 비싼 **아시아(도쿄/서울 등) 리전 기준($0.12/GB)**으로 보수적 계산을 수행했습니다.

*   **API 1회 응답 크기 가정**: **5KB** (헤더 포함 넉넉하게 잡음)
*   **사용 가능 데이터 양**: `$3.06` ÷ `$0.12` = **약 25.5 GB**
*   **월 최대 호출 가능 횟수**: `25.5 GB` ÷ `5 KB` ≈ **5,340,000회 (534만 회)**

### ⚠️ 위험 시나리오 (Client Side Polling)
유저 브라우저에서 직접 Fly.io API를 3초마다 호출한다면?
*   **동시 접속자 10명**: 월 860만 회 호출 ➡️ **한도 초과 (과금 발생 💸)**
*   **동시 접속자 100명**: 월 8,600만 회 호출 ➡️ **요금 폭탄 💣**

---

## 3. ✅ 솔루션: Backend Proxy & Caching 전략

시청자가 10명이든 1만 명이든, Fly.io 서버 비용을 **0원**으로 고정하기 위해 **메인 백엔드 서버가 중계(Proxy)**하는 방식을 사용해야 합니다.

### 🏗️ 아키텍처 도식
```mermaid
graph LR
    User[수많은 시청자들] --(요청)--> MainServer[메인 백엔드\n(Next.js 등)]
    MainServer --(단일 요청)--> Fly[Fly.io 지창 봇\n(soop-chat-ji)]
```

### 🛠️ 구현 방법
1.  **메인 서버(Backend)**가 Fly.io 서버의 `/stats` API를 **주기적(예: 5분)**으로 호출합니다.
2.  받아온 데이터를 메인 서버의 메모리나 DB(Redis 등)에 **캐싱(잠시 저장)**합니다.
3.  **유저(Client)**들은 Fly.io에 직접 붙는 게 아니라, **메인 서버의 캐시된 데이터**를 조회합니다.

### 📈 효과
*   **호출 횟수 고정**: 유저가 아무리 많아도 Fly.io 서버는 메인 서버로부터 **5분에 1번(월 약 8,600회)**만 호출받습니다.
*   **비용 0원 확정**: 월 8,600회는 허용 한도(534만 회)의 **0.16%** 수준으로, 데이터 전송량이 거의 없습니다.
*   **보안 강화**: Fly.io 서버의 주소를 숨길 수 있어 DDoS 등 공격으로부터 안전해집니다.

## 4. 결론
> **"메인 백엔드 서버를 통해 5분마다 데이터를 가져오면, 데이터 비용은 사실상 0에 수렴하며 평생 무료로 안전하게 운영 가능합니다."**
